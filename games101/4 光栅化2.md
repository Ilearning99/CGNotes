# 光栅化

## 三角形的光栅化

### 光栅化等价于2维采样

- 判断平面上每个像素是否在三角形内

- 定义二值函数: inside(tri, x, y)

  - 入参: tri三角形，x, y不一定是整数

  - 功能:
    $$
    inside(t, x, y) = \left\{
    \begin{aligned}
    1 && 点(x, y)在三角形t内\\
    0 && 其他
    \end{aligned}
    \right.
    $$

- 光栅化=采样一个2维指示函数

  ```.c
  for (int x = 0; x < xmax; ++x)
      for (int y = 0; y < ymax; ++y)
          image[x][y] = inside(tri, x+0.5, y+0.5);
  ```

  - 像素$(x,y)$的中心是$(x+0.5, y+0.5)$

- 如何评估一个点是不是在三角形内

  - 通过三个内积是否符号一直判断

- 边界条件，如果一个像素点在两个三角形共有的边上

  - 不做特殊处理
  - 图形学Directx和OpenGL，规定在三角形的上边和左边的点，认为在三角形内，在三角形下边和右边的点，认为在三角形外

### 是否需要检查屏幕中的所有像素点

- 只考虑判断三角形左右上下边界范围内的点$[l, r] \times [t, d]$
  - 轴向包围盒 axis aligned bounding box
- 增量遍历
  - 找到每行的包围盒

### 真实显示屏幕上的光栅化

- 真实液晶屏的像素
  - 更多绿色的点，人眼对绿色更敏感
  - 不是正方形是长条形
- 彩色打印机
  - 减色系统
  - 需要节省墨水
- 当前课程假设，像素是内部颜色均匀的小方块

### 锯齿(Jaggies)

- 主要原因
  - 像素本身有一定大小
  - 采样率对于信号来说不够高
- 走样(aliasing)
  - 抗锯齿
  - 反走样